---
- name: Configure CSR1000v
hosts: CSR1kv
gather_facts: false
connection: local

tasks:
- name: Configure IPv6 Address
ios_config:
parents:
- interface GigabitEthernet1
lines:
- description IPv6 addresses (GUA and Link Local)
- ipv6 address 2001:db8:acad:1::1/64
- ipv6 address fe80::1 link-local

- name: Display the interface ipv6 addresses of the hosts
ios_command:
commands:
- show ipv6 int brief
register: output

- name: Save the output of ipv6 addresses to a file
copy:
content: "{{ output.stdout[0] }}"
dest: "backups/showipv6_run_{{ inventory_hostname }}.txt"


(csr1kv) devasc@labvm:~/labs/devnet-src/pyats/csr1kv$ genie create testbed interactive --output yaml/testbed.yml --encode-password
Start creating Testbed yaml file ...
Do all of the devices have the same username? [y/n] n
Do all of the devices have the same default password? [y/n] n
Do all of the devices have the same enable password? [y/n] n

Device hostname: CSR1kv
   IP (ip, or ip:port): 192.168.56.101
   Username: cisco
Default Password (leave blank if you want to enter on demand): cisco123!
Enable Password (leave blank if you want to enter on demand): 
   Protocol (ssh, telnet, ...): ssh -o KexAlgorithms=diffie-hellman-group14-sha1
   OS (iosxr, iosxe, ios, nxos, linux, ...): iosxe
More devices to add ? [y/n] n
Testbed file generated: 
yaml/testbed.yml 

(csr1kv) devasc@labvm:~/labs/devnet-src/pyats/csr1kv$


genie parse "show ip interface brief" --testbed-file yaml/testbed.yml --devices CSR1kv

genie parse "show version" --testbed-file yaml/testbed.yml --devices CSR1kv



a.	On the CSR1kv VM add the following IPv6 address: 
CSR1kv(config)# interface gig 1
CSR1kv(config-if)# ipv6 address 2001:db8:acad:56::101/64
Step 2: Use Genie to verify configuration and parse output in JSON.
a.	Parse unstructured output from the show ipv6 interface command into structured JSON. Use the --output parameter to send the output to a directory verify-ipv6-1. Notice in the output that Genie tells you that two files were created.
(csr1kv) devasc@labvm:~/labs/devnet-src/pyats/csr1kv$ genie parse "show ipv6 interface gig 1" --testbed-file yaml/testbed.yml --devices CSR1kv --output verify-ipv6-1
Enter enable password for device CSR1kv: <Enter>
2020-05-31T19:36:19: %UNICON-WARNING: Device 'CSR1kv' 
